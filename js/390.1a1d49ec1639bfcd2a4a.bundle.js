"use strict";(self.webpackChunkreact=self.webpackChunkreact||[]).push([[390],{80390:function(e,t,n){n.r(t),n.d(t,{default:function(){return A}});var o=n(33938),l=n(45567),r=n(63109),a=n.n(r),i=n(66419),c=n.n(i),d=n(93476),s=n.n(d),p=n(2991),u=n.n(p),m=n(77766),f=n.n(m),h=(n(68309),n(67294)),g=n(21588),v=n(55733),w=n.n(v),b=n(93162),x=n.n(b),E=(0,n(66221).E)(!0),y=n(29163),k=y.ZP.label.withConfig({displayName:"upload__UploadAreaStyles",componentId:"sc-ompfim-0"})(["padding:4rem 2rem;display:block;cursor:pointer;"]),C=y.ZP.div.withConfig({displayName:"upload__PopupBoxStyles",componentId:"sc-ompfim-1"})(["display:",";background-color:rgba(0,0,0,0.8);z-index:2;width:100vw;height:100vh;position:fixed;top:0;left:0;.inner{position:relative;}.content{padding:2rem 8px;height:30rem;width:50rem;overflow:auto;background-color:#fff;}.box{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:2;}span{color:#fff;font-weight:700;cursor:pointer;font-size:2rem;position:absolute;right:0.2rem;top:-2rem;z-index:2;}"],(function(e){return e.showPopupBox?"block":"none"})),_=y.ZP.td.withConfig({displayName:"upload__ActionStyles",componentId:"sc-ompfim-2"})(["",""],"\n\n  cursor: pointer;\n"),S=y.ZP.div.withConfig({displayName:"upload__WrapStyles",componentId:"sc-ompfim-3"})(["height:40vh;overflow:auto;margin:25px auto;"]),P=y.ZP.table.withConfig({displayName:"upload__TableStyles",componentId:"sc-ompfim-4"})(["width:100%;text-align:left;position:relative;font-family:'Arial';border-collapse:collapse;border:1px solid #eee;border-bottom:2px solid #00cccc;box-shadow:0px 0px 20px rgba(0,0,0,0.1),0px 10px 20px rgba(0,0,0,0.05),0px 20px 20px rgba(0,0,0,0.05),0px 30px 20px rgba(0,0,0,0.05);tr{&:hover{background:#f4f4f4;td{color:#555;}}}th,td{padding:0.25rem;color:#999;border:1px solid #eee;padding:12px;border-collapse:collapse;}th{position:sticky;top:0;z-index:1;box-shadow:0 2px 2px -1px rgba(0,0,0,0.4);}td{position:relative;input{width:100%;}span{position:absolute;left:0;right:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}}th{background:#00cccc;color:#fff;text-transform:uppercase;font-size:12px;&.last{border-right:none;}}"]),Z=y.ZP.div.withConfig({displayName:"upload__ContainerStyles",componentId:"sc-ompfim-5"})(["height:100vh;color:rgb(204,199,192);background-color:rgb(26,41,49);padding:2rem 1.25rem;"]),D=y.ZP.svg.withConfig({displayName:"upload__SvgStyles",componentId:"sc-ompfim-6"})(["fill:rgb(174,167,156);width:100%;height:80px;fill:#92b0b3;display:block;margin-bottom:40px;"]),z=y.ZP.form.withConfig({displayName:"upload__FormStyles",componentId:"sc-ompfim-7"})(["font-size:1.25rem;background-color:rgb(38,59,65);position:relative;text-align:center;outline-offset:-10px;outline:2px dashed #92b0b3;outline-color:rgb(74,80,83);transition:outline-offset 0.15s ease-in-out,background-color 0.15s linear;"," input{width:0.1px;height:0.1px;opacity:0;overflow:hidden;position:absolute;z-index:-1;}input + label{max-width:80%;text-overflow:ellipsis;white-space:nowrap;cursor:pointer;display:inline-block;overflow:hidden;strong{font-weight:700;}span{display:inline;}}"],(function(e){return e.isDragOver?"outline-offset: -20px;outline-color: #c8dadf;background-color: #fff;":""})),I=void 0,N=function(e){var t=e.handlePreview,n=e.handleDownload,o=e.data,r=(0,h.useState)(""),a=(0,l.Z)(r,2),i=a[0],c=a[1],d=(0,h.useState)(""),s=(0,l.Z)(d,2),p=s[0],u=s[1];return h.createElement(h.Fragment,null,h.createElement("td",null,h.createElement("span",null,o.name)," "),h.createElement("td",null,h.createElement("input",{value:i,onChange:function(e){c(e.target.value)}})),h.createElement("td",null,h.createElement("input",{value:p,onChange:function(e){u(e.target.value)}})),h.createElement(_,{onClick:t.bind(I,o,i,p)},"预览!"),h.createElement(_,{onClick:n.bind(I,o,i,p)},"下载!"))},A=function(){var e,t=(0,h.useState)(""),n=(0,l.Z)(t,2),r=n[0],i=n[1],d=(0,h.useState)(!1),p=(0,l.Z)(d,2),m=p[0],v=p[1],b=(0,h.useState)([]),y=(0,l.Z)(b,2),_=y[0],A=y[1],T=(0,h.useState)(!1),F=(0,l.Z)(T,2),B=F[0],O=F[1],R=(0,h.useRef)(!1),U=(0,h.useRef)(null),H=("draggable"in(e=document.createElement("div"))||"ondragstart"in e&&"ondrop"in e)&&"FormData"in window&&"FileReader"in window;(0,h.useEffect)((function(){console.log("check isAdvancedUpload ",H)}),[]);var L=function(e,t,n){g.convertToHtml({arrayBuffer:n},{convertImage:g.images.imgElement(X)}).then(W.bind(I,e,t)).done()},M=function(e){return e.every((function(e){return"application/vnd.openxmlformats-officedocument.wordprocessingml.document"===e.type}))},X=function(e){return alert("包含图片会使html文件过大，请注意！！！"),e.read("base64").then((function(t){return{src:"data:"+e.contentType+";base64,"+t}}))},q=function(e,t){return new(s())((function(n,o){var l=t,r=new FileReader;r.onload=function(t){var o=t.target.result;e(o),n(o)},r.onerror=function(e){console.log("show err",e),o(e)},r.readAsArrayBuffer(l)}))},W=function(e,t,n){var o,l,r,a,c,d=(o={content:n.value,title:e},a=o.title,c=o.content,f()(l=f()(r='\n    <!DOCTYPE html>\n<html lang="en">\n<head>\n\t<meta charset="UTF-8">\n\t<meta http-equiv="X-UA-Compatible" content="IE=edge">\n\t<meta name="viewport" content="width=device-width, initial-scale=1.0">\n\t<title>'.concat(a,"</title>\n\t<style>\n\t")).call(r,E,"\n\t</style>\n</head>\n<body>\n\n")).call(l,c,"\n</body>\n</html>\n    "));i(n.value),console.log("check isDownload ",R.current),R.current&&function(e,t){var n=w()();n.file("".concat(t,".html"),e),n.generateAsync({type:"blob"}).then((function(e){var t=(new Date).getTime(),n="combined-".concat(t,".zip");return x().saveAs(e,n)}))}(d,t)},Y=function(e){e.preventDefault(),e.stopPropagation()},j=function(e){Y(e),v(!0)},G=function(e){Y(e),v(!1)},J=function(e,t,n){n&&t?(R.current=!0,console.log("download"),q(L.bind(I,t,n),e)):alert("请填写标题和下载文件名")},K=function(){var e=(0,o.Z)(a().mark((function e(t,n,o){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,R.current=!1,e.next=4,q(L.bind(I,n,o),t);case 4:O(!0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("preview error",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n,o){return e.apply(this,arguments)}}(),Q=function(){O(!1)};return h.createElement(h.Fragment,null,h.createElement(C,{onClick:Q,showPopupBox:B},h.createElement("div",{className:"box"},h.createElement("div",{className:"inner"},h.createElement("div",{className:"content",dangerouslySetInnerHTML:{__html:r}}),h.createElement("span",{onClick:Q},"X")))),h.createElement(Z,null,h.createElement(S,null,h.createElement(P,null,h.createElement("thead",null,h.createElement("tr",null,h.createElement("th",null,"word文件名"),h.createElement("th",null,"html标题"),h.createElement("th",null,"html文件名"),h.createElement("th",null,"预览"),h.createElement("th",null,"下载"))),h.createElement("tbody",null,u()(_).call(_,(function(e,t){var n;return h.createElement("tr",{key:f()(n="".concat(t,"-")).call(n,e.name)},h.createElement(N,{data:e,handleDownload:J,handlePreview:K}))}))))),h.createElement(z,{ref:U,isDragOver:m,onDragOver:j,onDragEnter:j,onDragEnd:G,onDragLeave:G,onDrop:function(e){G(e);var t=c()(e.dataTransfer.files);!1!==M(t)?A(t):alert("只支持words文件")},encType:"multipart/form-data"},h.createElement("div",null,h.createElement(k,{htmlFor:"file"},h.createElement(D,{xmlns:"http://www.w3.org/2000/svg",width:"50",height:"43",viewBox:"0 0 50 43"},h.createElement("path",{d:"M48.4 26.5c-.9 0-1.7.7-1.7 1.7v11.6h-43.3v-11.6c0-.9-.7-1.7-1.7-1.7s-1.7.7-1.7 1.7v13.2c0 .9.7 1.7 1.7 1.7h46.7c.9 0 1.7-.7 1.7-1.7v-13.2c0-1-.7-1.7-1.7-1.7zm-24.5 6.1c.3.3.8.5 1.2.5.4 0 .9-.2 1.2-.5l10-11.6c.7-.7.7-1.7 0-2.4s-1.7-.7-2.4 0l-7.1 8.3v-25.3c0-.9-.7-1.7-1.7-1.7s-1.7.7-1.7 1.7v25.3l-7.1-8.3c-.7-.7-1.7-.7-2.4 0s-.7 1.7 0 2.4l10 11.6z"})),h.createElement("input",{onChange:function(e){var t,n;console.log("check files type",null==e||null===(t=e.target)||void 0===t?void 0:t.files);var o=c()(null==e||null===(n=e.target)||void 0===n?void 0:n.files);!1!==M(o)?A(o):alert("只支持words文件")},id:"file",type:"file",multiple:!0}),h.createElement("div",null,h.createElement("strong",null,"点击上传"),h.createElement("span",null," 或将文件拖拽至此"),"."))))))}}}]);